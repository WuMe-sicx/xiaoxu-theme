import{a as e,_ as a,N as l,n as t,r as u}from"./Layout.vue_vue_type_script_setup_true_lang-DggjovG3.js";import{_ as n}from"./Content.vue_vue_type_script_setup_true_lang-BU2yl4QK.js";import{d as r,b as s,e as o,g as c,a as i,i as d,aM as m,k as p,c as v,o as f,p as _,q as y,aQ as b,L as g,A as h,C as w,B as $,R as x,y as C,E as k,G as L,F as z,D as P}from"./index-HMHCBO22.js";import{_ as j}from"./Back.vue_vue_type_script_setup_true_lang-CqzeplWU.js";import{u as O}from"./order-Cj0MfuB_.js";import{u as S,_ as M}from"./usePayment-j-zj-I0s.js";import{C as N}from"./CheckCircleOutlined-D_8vxthy.js";import{N as B,a as D}from"./DescriptionsItem-D3Ta2R0i.js";import{u as I}from"./composables-sjxCGT15.js";const T={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 1024 1024"},U=[c("path",{d:"M685.4 354.8c0-4.4-3.6-8-8-8l-66 .3L512 465.6l-99.3-118.4l-66.1-.3c-4.4 0-8 3.5-8 8c0 1.9.7 3.7 1.9 5.2l130.1 155L340.5 670a8.32 8.32 0 0 0-1.9 5.2c0 4.4 3.6 8 8 8l66.1-.3L512 564.4l99.3 118.4l66 .3c4.4 0 8-3.5 8-8c0-1.9-.7-3.7-1.9-5.2L553.5 515l130.1-155c1.2-1.4 1.8-3.3 1.8-5.2z",fill:"currentColor"},null,-1),c("path",{d:"M512 65C264.6 65 64 265.6 64 513s200.6 448 448 448s448-200.6 448-448S759.4 65 512 65zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372s372 166.6 372 372s-166.6 372-372 372z",fill:"currentColor"},null,-1)],E=r({name:"CloseCircleOutlined",render:function(e,a){return o(),s("svg",T,U)}}),Q={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 1024 1024"},R=[c("path",{d:"M464 720a48 48 0 1 0 96 0a48 48 0 1 0-96 0zm16-304v184c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V416c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8zm475.7 440l-416-720c-6.2-10.7-16.9-16-27.7-16s-21.6 5.3-27.7 16l-416 720C56 877.4 71.4 904 96 904h832c24.6 0 40-26.6 27.7-48zm-783.5-27.9L512 239.9l339.8 588.2H172.2z",fill:"currentColor"},null,-1)],V=r({name:"WarningOutlined",render:function(e,a){return o(),s("svg",Q,R)}}),q={class:"flex flex-col space-y-3 my-6 items-center justify-center"},A={class:"flex space-x-1 w-full items-center"},F=["title"],G={class:"text-red-500"},H={class:"text-red-500"},W={key:0,class:"text-xs"},J={key:0},K={class:"flex justify-end space-x-2 w-full mt-4"},X=r({__name:"DetailView",setup(r){const T=g(),U=e(),Q=I(),R=i({}),X=d(),Y=O(),Z=m(),{t:ee}=p(),ae=i(""),{handlePayment:le,validatePayment:te}=S();async function ue(){var e,a,l;const t=await b({path:{trade_no:T.params.trade_no.toString()}});if("error"===(null==(e=t.data)?void 0:e.status))return U.error(null==(a=t.data)?void 0:a.message);R.value=null==(l=t.data)?void 0:l.data}const ne=v((()=>({cancelled:ee("Cancelled"),unpaid:ee("Unpaid"),paid:ee("Paid")}))),re=v((()=>({cancelled:"red",unpaid:"yellow",paid:"green"}))),se={cancelled:E,unpaid:V,paid:N};async function oe(){te(ae.value,R.value.amount)&&await le(ae.value,T.params.trade_no.toString())}async function ce(){try{await Y.cancelOrder(T.params.trade_no.toString(),Q,ee),U.success(ee("Cancellation successful")),ue()}catch(e){}}return f((()=>{ue()})),(e,r)=>(o(),_(a,{"header-title":e.$t("Order Details"),"toggle-header":!1,"show-footer":!1},{default:y((()=>[h(n,{class:"mx-auto p-4 md:p-10 space-y-5"},{default:y((()=>[h(j,{to:"/user/orders"}),h($(x),null,{default:y((()=>[c("div",q,[h($(l),{size:50,color:re.value[R.value.status],component:se[R.value.status]},null,8,["color","component"]),c("p",null,C(ne.value[R.value.status]),1)])])),_:1}),h($(x),{title:e.$t("Package Snapshot")},{default:y((()=>[h($(B),{"content-class":"ml-10",columns:1,size:"large","label-placement":"left",separator:""},{default:y((()=>[h($(D),{label:e.$t("Name")},{default:y((()=>{var e;return[k(C(null==(e=R.value.snapshot)?void 0:e.name),1)]})),_:1},8,["label"]),h($(D),{label:e.$t("Intro")},{default:y((()=>{var e;return[k(C(null==(e=R.value.snapshot)?void 0:e.intro),1)]})),_:1},8,["label"]),h($(D),{label:e.$t("Badge")},{default:y((()=>{var e;return[k(C(null==(e=R.value.snapshot)?void 0:e.badge),1)]})),_:1},8,["label"]),h($(D),{label:e.$t("Privileges")},{default:y((()=>{var e;return[(o(!0),s(z,null,L((null==(e=R.value.snapshot)?void 0:e.features)||[],(e=>(o(),s("div",A,[h($(l),{size:16,color:"green",component:$(N)},null,8,["component"]),c("p",{class:"w-full truncate",title:e},C(e),9,F)])))),256))]})),_:1},8,["label"])])),_:1})])),_:1},8,["title"]),h($(x),{title:e.$t("Product Information")},{default:y((()=>[h($(B),{"content-class":"ml-10",columns:1,size:"large","label-placement":"left",separator:""},{default:y((()=>[h($(D),{label:e.$t("Name")},{default:y((()=>{var e;return[k(C(null==(e=R.value.product)?void 0:e.name),1)]})),_:1},8,["label"]),h($(D),{label:e.$t("Duration")},{default:y((()=>{var a;return[k(C(e.$t("{minutes} minutes",{minutes:null==(a=R.value.product)?void 0:a.duration})),1)]})),_:1},8,["label"]),h($(D),{label:e.$t("Price")},{default:y((()=>{var e,a;return[c("p",G,C($(t).currency(null==(e=R.value.product)?void 0:e.price,null==(a=$(X).configs)?void 0:a.app.currency,$(Z).locale)),1)]})),_:1},8,["label"])])),_:1})])),_:1},8,["title"]),h($(x),{title:e.$t("Order Information")},{default:y((()=>[h($(B),{"content-class":"ml-10",columns:1,size:"large","label-placement":"left",separator:""},{default:y((()=>[h($(D),{label:e.$t("Order Number")},{default:y((()=>[k(C(R.value.trade_no),1)])),_:1},8,["label"]),h($(D),{label:e.$t("Order Status")},{default:y((()=>[k(C(ne.value[R.value.status]),1)])),_:1},8,["label"]),R.value.pay_method?(o(),_($(D),{key:0,label:e.$t("Payment Method")},{default:y((()=>[k(C(R.value.pay_method),1)])),_:1},8,["label"])):w("",!0),R.value.paid_at?(o(),_($(D),{key:1,label:e.$t("Payment Time")},{default:y((()=>[k(C($(u)(R.value.paid_at).format("LLL")),1)])),_:1},8,["label"])):w("",!0),R.value.canceled_at?(o(),_($(D),{key:2,label:e.$t("Cancellation Time")},{default:y((()=>[k(C($(u)(R.value.canceled_at).format("LLL")),1)])),_:1},8,["label"])):w("",!0),h($(D),{label:e.$t("Creation Time")},{default:y((()=>[k(C($(u)(R.value.created_at).format("LLL")),1)])),_:1},8,["label"]),h($(D),{label:e.$t("Total Price")},{default:y((()=>{var a,l;return[c("p",H,C($(t).currency(R.value.amount,null==(a=$(X).configs)?void 0:a.app.currency,$(Z).locale)),1),R.value.deduct_amount>0?(o(),s("span",W,C(e.$t("Use the coupon to deduct {amount}",{amount:$(t).currency(R.value.deduct_amount,null==(l=$(X).configs)?void 0:l.app.currency,$(Z).locale)})),1)):w("",!0)]})),_:1},8,["label"])])),_:1})])),_:1},8,["title"]),"unpaid"===R.value.status?(o(),s("div",J,[h($(x),{title:e.$t("Checkout")},{default:y((()=>[R.value.amount>0?(o(),_(M,{key:0,value:ae.value,"onUpdate:value":r[0]||(r[0]=e=>ae.value=e)},null,8,["value"])):w("",!0),c("div",K,[R.value.amount>0?(o(),_($(P),{key:0,type:"primary",disabled:""===ae.value,size:"small",onClick:oe},{default:y((()=>[k(C(e.$t("Proceed to Payment")),1)])),_:1},8,["disabled"])):(o(),_($(P),{key:1,type:"primary",size:"small",onClick:oe},{default:y((()=>[k(C(e.$t("Pay Now")),1)])),_:1})),h($(P),{type:"error",size:"small",onClick:ce},{default:y((()=>[k(C(e.$t("Cancel Order")),1)])),_:1})])])),_:1},8,["title"])])):w("",!0)])),_:1})])),_:1},8,["header-title"]))}});export{X as default};
