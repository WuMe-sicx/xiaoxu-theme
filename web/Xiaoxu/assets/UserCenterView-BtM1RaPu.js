import{d as e,b as a,e as l,g as t,a as s,c as r,A as o,B as n,C as u,y as i,D as c,q as d,E as v,F as p,G as m,p as f,i as h,j as b,u as g,M as w,o as x,ca as k,L as _,cb as y,J as j,v as C,x as z,cc as $,cd as q}from"./index-HMHCBO22.js";import{_ as A,E as U}from"./ExploreImage-Ck7KAk54.js";import{c as I,d as L,N as B,z as D,K as M,n as E,a as O,_ as P,ad as S,ae as R,h as W,i as H,I as N}from"./Layout.vue_vue_type_script_setup_true_lang-DggjovG3.js";import{W as T}from"./WaterfallLayout-Bhg1tzW2.js";import{_ as F}from"./Content.vue_vue_type_script_setup_true_lang-BU2yl4QK.js";import{N as G}from"./Upload-D3M0ZpTb.js";const J={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},K=[t("path",{d:"M208 352h-64a96 96 0 0 1 0-192h64",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"36"},null,-1),t("path",{d:"M304 160h64a96 96 0 0 1 0 192h-64",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"36"},null,-1),t("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"36",d:"M163.29 256h187.42"},null,-1)],V=e({name:"LinkOutline",render:function(e,t){return l(),a("svg",J,K)}}),Q={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},X=[t("path",{d:"M256 48c-79.5 0-144 61.39-144 137c0 87 96 224.87 131.25 272.49a15.77 15.77 0 0 0 25.5 0C304 409.89 400 272.07 400 185c0-75.61-64.5-137-144-137z",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),t("circle",{cx:"256",cy:"192",r:"48",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1)],Y=e({name:"LocationOutline",render:function(e,t){return l(),a("svg",Q,X)}}),Z={class:"flex flex-col sm:flex-row sm:space-x-16 w-full p-6"},ee={class:"flex basis-1/3 justify-center sm:justify-end shrink-0"},ae={class:"flex grow justify-start flex-col space-y-4"},le={class:"flex items-center mb-2"},te={class:"text-3xl font-bold sm:mr-2 text-inherit drop-shadow-lg"},se={class:"text-inherit drop-shadow-md"},re={key:0,class:"flex items-center space-x-1 text-inherit drop-shadow-md"},oe={key:1},ne={key:2},ue={class:"text-base mb-4 text-inherit drop-shadow-md"},ie={class:"flex flex-wrap gap-3"},ce=e({__name:"UserInfo",props:{user:{type:Object,required:!0,default:()=>{}},showBackgroundControls:{type:Boolean,default:!0}},setup(e){const h=s(null),b=e,g=r((()=>{var e;return((null==(e=b.user)?void 0:e.socials)||[]).map((e=>({label:e,props:{onClick:()=>window.open(e)}})))}));function w(){var e;null==(e=h.value)||e.open({path:{username:b.user.username}})}return(e,s)=>{var r,x;return l(),a(p,null,[o(A,{ref_key:"reportRef",ref:h,type:"user"},null,512),t("div",Z,[t("div",ee,[o(n(I),{round:"",size:120,src:n(L).getUserAvatar(b.user.avatar_url)},null,8,["src"])]),t("div",ae,[t("div",le,[t("div",te,i(b.user.name),1),o(n(c),{secondary:"",strong:"",size:"tiny",onClick:w,class:"bg-white/20 border-white/30 text-inherit hover:bg-white/30"},{default:d((()=>[v(i(e.$t("Report")),1)])),_:1})]),t("p",se,i(b.user.bio),1),b.user.location?(l(),a("p",re,[o(n(B),{size:16,component:n(Y)},null,8,["component"]),t("span",null,i(b.user.location),1)])):u("",!0),g.value?(l(),a("div",oe,[o(n(D),{placement:"bottom-start",trigger:"click",options:g.value,"show-arrow":""},{default:d((()=>[o(n(c),{text:"",class:"text-inherit hover:bg-white/20"},{icon:d((()=>[o(n(B),{component:n(V)},null,8,["component"])])),default:d((()=>[v(" "+i(e.$t("Social Accounts")),1)])),_:1})])),_:1},8,["options"])])):u("",!0),(null==(r=b.user)?void 0:r.interests)?(l(),a("div",ne,[t("p",ue,i(e.$t("Interested Tags")),1),t("div",ie,[(l(!0),a(p,null,m((null==(x=b.user)?void 0:x.interests)||[],(e=>(l(),f(n(M),{bordered:!1,class:"bg-white/20 text-inherit border-white/30"},{default:d((()=>[v(i(e),1)])),_:2},1024)))),256))])])):u("",!0)])])],64)}}}),de="/assets/empty-image-Dvbju7a-.png",ve={class:"flex overflow-hidden rounded-md h-[200px]"},pe={class:"flex basis-2/3 border-r shrink-0"},me=["src"],fe={class:"flex basis-1/3 flex-col"},he=["src"],be=["src"],ge={class:"flex flex-col w-full mt-4 space-y-2"},we={class:"text-base truncate"},xe={class:"text-md text-gray-500 dark:text-gray-400"},ke=e({__name:"ExploreAlbum",props:{album:{type:Object,required:!0,default:()=>{}}},setup(e){const s=e;return(e,r)=>(l(),a("div",{class:"flex flex-col w-full hover:opacity-75 transition-all cursor-pointer",onClick:r[0]||(r[0]=()=>{return e=`/explore/albums/${s.album.id}`,void window.open(e,"_blank");var e})},[t("div",ve,[t("div",pe,[t("img",{src:s.album.covers[0]||n(de),alt:"Album Cover",class:"w-full h-full object-cover"},null,8,me)]),t("div",fe,[t("img",{src:s.album.covers[1]||n(de),alt:"Album Cover",class:"w-full h-full border-b object-cover shrink-0 overflow-hidden basis-1/2"},null,8,he),t("img",{src:s.album.covers[2]||n(de),alt:"Album Cover",class:"w-full h-full object-cover shrink-0 overflow-hidden basis-1/2"},null,8,be)])]),t("div",ge,[t("p",we,i(s.album.name),1),t("p",xe,i(e.$t("{count} photos",{count:n(E).format(s.album.photo_count||0)}))+" · Curated by "+i(s.album.user.name),1)])]))}}),_e={key:0,class:"absolute top-4 right-4 z-10"},ye={class:"w-full px-2"},je={class:"flex items-center space-x-2 text-md"},Ce={class:"flex items-center space-x-2 text-md"},ze={class:"my-4"},$e={key:0,class:"px-2"},qe={key:1,class:"px-4"},Ae={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4 sm:gap-8"},Ue=e({__name:"UserCenterView",setup(e){var A,I;const L=_(),D=g(),M=O(),E=h(),J=b();E.configs&&!(null==(I=null==(A=E.configs)?void 0:A.app)?void 0:I.enable_explore)&&D.replace("/404");const K=s({}),V=s("photo"),Q=s([]),X=s(""),Y=s(1),Z=s(!1),ee=s(!1),ae=s(Date.now());async function le(e={}){var a,l,t,s,r;if(!Z.value&&!ee.value){Z.value=!0;try{const o={photo:j,album:y},n=await o[V.value]({query:{q:X.value,page:Y.value,username:K.value.username,per_page:20,...e}});if("error"===(null==(a=n.data)?void 0:a.status))return M.error(null==(l=n.data)?void 0:l.message),void(Z.value=!1);const u=(null==(t=n.data)?void 0:t.data.data)||[];Q.value.push(...u),ee.value=(null==(s=n.data)?void 0:s.data.meta.last_page)===(null==(r=n.data)?void 0:r.data.meta.current_page),u.length>0&&Y.value++}catch(o){M.error("加载失败，请重试")}finally{Z.value=!1}}}function te(e){const a=e.target;100+a.scrollTop+a.clientHeight>=a.scrollHeight&&(Z.value||ee.value||le())}w(V,(()=>{Q.value=[],X.value="",Y.value=1,Z.value=!1,ee.value=!1,le()}));const se=r((()=>{var e;return J.isLoggedIn&&(null==(e=J.profile)?void 0:e.username)===K.value.username}));async function re(e){var a,l;try{const t=await $({body:{background:e.file.file}});"success"===(null==(a=t.data)?void 0:a.status)?(M.success("背景图片设置成功"),ae.value=Date.now(),await J.fetchUserProfile(),await ne()):M.error((null==(l=t.data)?void 0:l.message)||"设置失败")}catch(t){M.error("设置失败，请重试")}}async function oe(){var e,a;try{const l=await q();"success"===(null==(e=l.data)?void 0:e.status)?(M.success("背景图片已移除"),ae.value=Date.now(),await J.fetchUserProfile(),await ne()):M.error((null==(a=l.data)?void 0:a.message)||"移除失败")}catch(l){M.error("移除失败，请重试")}}async function ne(){var e,a,l;try{const t=await k({path:{username:L.params.username.toString()}});if("error"===(null==(e=t.data)?void 0:e.status))return D.back(),M.error(null==(a=t.data)?void 0:a.message);K.value=null==(l=t.data)?void 0:l.data,le()}catch(t){M.error("获取用户信息失败")}}return x((()=>{ne()})),(e,s)=>(l(),f(P,{"toggle-header":!1,"show-footer":!0,"header-title":e.$t("Square"),"on-scroll":te},{default:d((()=>[o(F,null,{default:d((()=>[t("div",{class:z(["relative flex w-full justify-center mb-4 xl:px-60 overflow-hidden py-10",[K.value.background_url?"text-white":""]]),style:C(K.value.background_url?{backgroundImage:`linear-gradient(rgba(0, 0, 0, 0.4), rgba(0, 0, 0, 0.4)), url(${K.value.background_url}?t=${ae.value})`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"}:{})},[se.value?(l(),a("div",_e,[K.value.background_url?(l(),f(n(c),{key:1,quaternary:"",size:"small",class:"bg-black/20 text-white hover:bg-black/40 hover:text-white border border-white/30",onClick:oe},{icon:d((()=>[o(n(B),{component:n(R)},null,8,["component"])])),default:d((()=>[s[2]||(s[2]=v(" 移除背景 "))])),_:1,__:[2]})):(l(),f(n(G),{key:0,"show-file-list":!1,accept:"image/*",max:1,"custom-request":re},{default:d((()=>[o(n(c),{quaternary:"",size:"small",class:"bg-black/20 text-gray-700 hover:bg-black/30 hover:text-gray-800 border border-gray-300"},{icon:d((()=>[o(n(B),{component:n(S)},null,8,["component"])])),default:d((()=>[s[1]||(s[1]=v(" 设置背景 "))])),_:1,__:[1]})])),_:1}))])):u("",!0),o(ce,{user:K.value,"show-background-controls":!1},null,8,["user"])],6),t("div",ye,[o(n(W),{type:"line",animated:"",value:V.value,"onUpdate:value":s[0]||(s[0]=e=>V.value=e)},{default:d((()=>[o(n(H),{name:"photo"},{default:d((()=>[t("div",je,[o(n(B),{size:20,component:n(S)},null,8,["component"]),t("span",null,i(e.$t("Photo"))+" "+i(K.value.photo_count>999?"999+":K.value.photo_count),1)])])),_:1}),o(n(H),{name:"album"},{default:d((()=>[t("div",Ce,[o(n(B),{size:20,component:n(N)},null,8,["component"]),t("span",null,i(e.$t("Album"))+" "+i(K.value.album_count>999?"999+":K.value.album_count),1)])])),_:1})])),_:1},8,["value"])]),t("div",ze,["photo"===V.value?(l(),a("div",$e,[o(T,{items:Q.value.map((e=>({...e,id:e.id}))),"column-width":200,gap:6},{default:d((({item:e})=>[o(U,{photo:e,photos:Q.value},null,8,["photo","photos"])])),_:1},8,["items"])])):u("",!0),"album"===V.value?(l(),a("div",qe,[t("div",Ae,[(l(!0),a(p,null,m(Q.value,(e=>(l(),f(ke,{album:e},null,8,["album"])))),256))])])):u("",!0)])])),_:1})])),_:1},8,["header-title"]))}});export{Ue as default};
