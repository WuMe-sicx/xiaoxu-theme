import{d as e,k as t,a,a2 as r,D as s,u as l,p as n,q as o,A as i,B as d,R as u,g as c,S as p,aP as m,e as _}from"./index-HMHCBO22.js";import{_ as f}from"./Content.vue_vue_type_script_setup_true_lang-BU2yl4QK.js";import{K as v,r as y,L as h,_ as k,g,N as w,S as j}from"./Layout.vue_vue_type_script_setup_true_lang-DggjovG3.js";import{_ as x}from"./DataTable.vue_vue_type_script_setup_true_lang-7wIpl8ID.js";import{u as b}from"./order-Cj0MfuB_.js";import{u as C}from"./composables-sjxCGT15.js";import"./Checkbox-dOjwP0iZ.js";import"./Ellipsis-CsA7j8A2.js";const W={class:"flex flex-col gap-2 md:flex-row md:items-center md:justify-between"},$={class:"grow md:grow-0 md:basis-1/2"},O=e({__name:"IndexView",setup(e){const O=l(),U=b(),{t:K}=t(),P=C(),S=a(),q=[{title:K("Order Number"),key:"trade_no",minWidth:250},{title:K("Product"),key:"snapshot.name",minWidth:300},{title:K("Payment Cycle"),key:"product.name",minWidth:200},{title:K("Order Amount"),key:"amount",minWidth:100,sorter:!0,align:"center"},{title:K("Order Status"),key:"status",minWidth:100,sorter:!0,align:"center",render(e){const t={cancelled:K("Cancelled"),unpaid:K("Unpaid"),paid:K("Paid")},a=e.status;return r(v,{type:{cancelled:"danger",unpaid:"warning",paid:"success"}[a]},{default:()=>t[a]??K("Unknown")})}},{title:K("Creation Time"),minWidth:200,key:"created_at",sorter:!0,align:"center",render:e=>y(e.created_at).format("L")},{title:K("Actions"),key:"actions",minWidth:170,fixed:"right",align:"center",render:e=>r(h,{vertical:!1,size:5,justify:"center"},{default:()=>[r(s,{size:"small",onClick:()=>{O.push(`/user/orders/${e.trade_no}`)}},{default:()=>K("Details")}),r(s,{disabled:"unpaid"!==e.status,size:"small",type:"error",onClick:async()=>{U.cancelOrder(e.trade_no,P,K).then((()=>{var e;D.value=[],null==(e=S.value)||e.refresh()}))}},{default:()=>K("Cancel Order")})]})}],z=a(""),A=a("sort:latest"),D=a([]),E=e=>m({query:{page:e,per_page:40,q:`${z.value} ${A.value}`.trim()}});function L(e){var t;e.order?A.value=`sort:${e.columnKey}:${e.order}`:A.value="sort:latest",null==(t=S.value)||t.refresh()}function N(){var e;null==(e=S.value)||e.refresh()}return(e,t)=>(_(),n(k,{"header-title":e.$t("Order Management"),"toggle-header":!1,"show-footer":!1},{default:o((()=>[i(f,{class:"mx-auto p-4 md:p-10 space-y-10"},{default:o((()=>[i(d(u),null,{default:o((()=>[i(d(h),{vertical:""},{default:o((()=>[c("div",W,[t[2]||(t[2]=c("div",null,null,-1)),c("div",$,[i(d(g),{value:z.value,"onUpdate:value":t[0]||(t[0]=e=>z.value=e),placeholder:e.$t("Enter keywords to search..."),onKeyup:p(N,["enter","native"])},{prefix:o((()=>[i(d(w),{component:d(j)},null,8,["component"])])),_:1},8,["value","placeholder"])])]),i(x,{striped:"",ref_key:"tableRef",ref:S,bordered:!1,fetch:E,columns:q,"row-key":e=>e.id,"checked-row-keys":D.value,"onUpdate:checkedRowKeys":t[1]||(t[1]=e=>D.value=e),onUpdateSorter:L},null,8,["row-key","checked-row-keys"])])),_:1})])),_:1})])),_:1})])),_:1},8,["header-title"]))}});export{O as default};
