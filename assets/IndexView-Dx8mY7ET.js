import{a2 as e,d as t,k as a,a as s,aF as r,D as o,aG as l,p as n,q as i,A as d,B as u,R as c,g as p,E as m,y as f,S as y,aH as h,e as v}from"./index-HMHCBO22.js";import{_}from"./Content.vue_vue_type_script_setup_true_lang-BU2yl4QK.js";import{g as w,a as g,K as k,n as x,r as C,L as b,y as j,_ as D,N as L,S as $}from"./Layout.vue_vue_type_script_setup_true_lang-DggjovG3.js";import{_ as S}from"./DataTable.vue_vue_type_script_setup_true_lang-7wIpl8ID.js";import{D as T}from"./DeleteOutlined-D1D-Si2V.js";import{u as z}from"./composables-sjxCGT15.js";import"./Checkbox-dOjwP0iZ.js";import"./Ellipsis-CsA7j8A2.js";const A={password:function(t,a={}){return e(w,{type:"password",showPasswordOn:"click",defaultValue:t,...a})}},E={class:"flex flex-col gap-2 md:flex-row md:items-center md:justify-between"},P={class:"grow md:grow-0 md:basis-1/2"},W=t({__name:"IndexView",setup(t){const W=g(),K=z(),{t:N}=a(),q=s(),R=[{type:"selection"},{title:N("Type"),key:"type",width:100,align:"center",render:t=>e(k,null,{default:()=>"photo"===t.type?N("Photo"):N("Album")})},{title:N("Password"),key:"password",minWidth:180,render:e=>e.password?A.password(e.password,{size:"small",onChange(t){r({path:{id:e.id},body:{password:t}}).then((()=>{W.success(N("Successfully updated"))})).catch((()=>{W.error(N("Modification failed"))}))}}):N("None")},{title:N("Views"),key:"view_count",minWidth:100,align:"center",sorter:!0,render:e=>x.format(e.view_count)},{title:N("Expiration Time"),minWidth:200,key:"expired_at",sorter:!0,align:"center",render:e=>e.expired_at?C(e.expired_at).format("LLL"):N("None")},{title:N("Creation Time"),minWidth:200,key:"created_at",sorter:!0,align:"center",render:e=>C(e.created_at).format("LLL")},{title:N("Actions"),key:"actions",minWidth:170,fixed:"right",align:"center",render:t=>e(b,{vertical:!1,size:5,justify:"center"},{default:()=>[e(o,{size:"small",onClick:()=>{j.copyText(`${window.location.origin}/shares/${t.slug}`).then((()=>{W.success(N("Copy successful"))})).catch((()=>{W.error(N("Copy failed"))}))}},{default:()=>N("Copy Link")}),e(o,{size:"small",type:"error",onClick:()=>{B([t.id],{title:N("Delete Share"),content:N("Are you sure you want to delete this share?")})}},{default:()=>N("Delete")})]})}],U=s(""),V=s("sort:latest"),F=s([]),M=e=>h({query:{page:e,per_page:40,q:`${U.value} ${V.value}`.trim()}});function O(e){var t;e.order?V.value=`sort:${e.columnKey}:${e.order}`:V.value="sort:latest",null==(t=q.value)||t.refresh()}function B(e,t){const a=K.warning({positiveText:N("Confirm"),negativeText:N("Cancel"),onPositiveClick:()=>(a.loading=!0,new Promise((t=>{l({body:e}).then((()=>{var e;W.success(N("Deleted successfully")),F.value=[],null==(e=q.value)||e.refresh(),t(!0)})).finally((()=>{a.loading=!1}))}))),...t})}function G(){var e;null==(e=q.value)||e.refresh()}return(e,t)=>(v(),n(D,{"header-title":e.$t("My Shares"),"toggle-header":!1,"show-footer":!1},{default:i((()=>[d(_,{class:"mx-auto p-4 md:p-10 space-y-10"},{default:i((()=>[d(u(c),null,{default:i((()=>[d(u(b),{vertical:""},{default:i((()=>[p("div",E,[p("div",null,[d(u(o),{type:"error",size:"small",disabled:F.value.length<=0,onClick:t[0]||(t[0]=()=>{B(F.value.map((e=>e)),{title:u(N)("Delete Share"),content:u(N)("Are you sure you want to delete the selected {count} shares?",{count:F.value.length})})})},{icon:i((()=>[d(u(L),{component:u(T)},null,8,["component"])])),default:i((()=>[m(" "+f(e.$t("Delete")),1)])),_:1},8,["disabled"])]),p("div",P,[d(u(w),{value:U.value,"onUpdate:value":t[1]||(t[1]=e=>U.value=e),placeholder:e.$t("Enter keywords to search..."),onKeyup:y(G,["enter","native"])},{prefix:i((()=>[d(u(L),{component:u($)},null,8,["component"])])),_:1},8,["value","placeholder"])])]),d(S,{striped:"",ref_key:"tableRef",ref:q,bordered:!1,fetch:M,columns:R,"row-key":e=>e.id,"checked-row-keys":F.value,"onUpdate:checkedRowKeys":t[2]||(t[2]=e=>F.value=e),onUpdateSorter:O},null,8,["row-key","checked-row-keys"])])),_:1})])),_:1})])),_:1})])),_:1},8,["header-title"]))}});export{W as default};
